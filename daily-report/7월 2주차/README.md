### (2022년 7월 10일) 발생되는 문제에 대한 내 생각
Bullet through paper 문제를 연속적인 충돌 감지로 해결했다고 생각했지만 해결이 되지 않았다. 어떤 문제인지 알아보기 위해 Gizmos.DrawWireCube 를 이용해 차량 에이전트를 둘러싸고 있는 cube를 그려봤다. 

<img src="https://github.com/sh02092/unity-ml-agents-DQN-based/blob/20fc3687769f0d2dacf8c5f7e0fe4b5801b27239/Image/around%20car%20agent.png" width="40%" height="30%">

차량에 설정한 Box Collider Component의 Edit Collider와 달라 이 부분에 의한 문제로 충돌 감지가 제대로 이루어지지 않는 것으로 추측된다. 아무래도 유니티에 대한 기초가 부족하여 구글링하여 나온 자료를 그대로 사용하다 보니 생긴 문제라고 생각된다.

유니티 자체를 내가 잘 이해하지 못하고 프로젝트를 진행하고 있다는 생각이 드는게.. position, localScale 을 box collider의 Center, Size로  변경하면 해결될까 싶어 진행해봤지만, 너무 다른 결과가 나와 혼란스럽다.

유니티 기본 component, 기능들에 대해 제대로 기초부터 공부해 봐야 할 것 같다.


### (2022년 7월 11일) 해결 방법은 찾았는데...
프로젝트에 ‘wall’ tag를 걸어준 연석들 box collider component의 is trigger를 체크하면, 충돌은 감지하지만, 막히지 않고 그대로 통과해버린다. 

기존의 Physics.OverlapBox(에이전트 중심, 에이전트 크기 절반)을 사용했을 경우 충돌 감지만으로 체크를 하여 EndEpisode() 를 할 수 있었지만, 위의 아직 해결하지 못한 문제로 인해 차량의 localScale과 보이는 차량의 크기가 달라 연석에 닿았을 경우 reset 되어야 하지만 그렇지 못하고 그대로 통과해버리는 것을 찾았다. 

OnCollisionEnter() 함수를 사용하여 연석의 is trigger 항목을 체크 해제 하면, collider끼리의 충돌이 발생할 경우 tag를 걸어주어 바로 EndEpisode()를 할 수 있도록 재설계했다.


### (2022년 7월 15일) 도로 환경을 바꾸고 학습이 이루어지지 않는다..
도로 환경이 간단해지면 간단해졌지 좁아지거나 어려운 커브길이 생긴것이 아니다.
하이퍼 파라미터 설계, 에이전트에 주어지는 보상 설계를 다시 해봐야겠다.

1. 이동한 거리에 비례하여 보상 부여: 단위 step 당 속도에 따라 이동한 거리에 보상을 부여하여 결과적으로 빠른 속도로 주행할 수 있도록 한다.

2. 벽(연석)에 부딪힐 경우 큰 (-) 보상 부여: 기존에 설계한 보상에서 벽에 부딪힐 경우 훨씬 큰 (-) 보상을 부여하여 벽에 박으면 큰일이 난다는 것을 인식할 수 있도록 한다.

3. 목표지점에 도착할 경우 큰 (+) 보상 부여: 벽에 부딪혔을 때와 비슷하게 큰 보상을 줌으로서 다시 목표지점에 도달할 수 있도록 한다.

4. 중앙선 넘어서 주행할 경우 복구 못할 정도의 (-) 보상 부여: 벽에 부딪혔을 때 만큼은 아니지만 큰 (-) 보상을 부여하여 다시 정상 주행을 해도 복구 못하도록 한다.

5. Epsilon greedy의 Epsilon-decay 키우기: 기존의 Epsilon greedy 방식에서는 Epsilon이 1에서 0.00001씩 선형적으로 감소하게 설계되어 있었다. 이에 평균적으로 4000 에피소드가 지남에도 랜덤한 행동 선택을 많이 할 것 같아 epsilon decay 크기를 키워 어느정도 에피소드가 지나면 maxQ 값에 따른 행동 선택을 하게끔 한다.

6. Target network update 작게: Target network update 횟수가 기존에는 너무 적어 학습이 제대로 이루어지지 않은 것이라 판단하여 작게한다.